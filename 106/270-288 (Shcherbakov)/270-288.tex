\documentclass{mai_book}

\defaultfontfeatures{Mapping=tex-text}
\setmainfont{DejaVuSerif}
\setdefaultlanguage{russian}

%\clearpage
\setcounter{page}{270} % ВОТ ТУТ ЗАДАТЬ СТРАНИЦУ
%\setcounter{thesection}{5} % ТАК ЗАДАВАТЬ ГЛАВЫ, ПАРАГРАФЫ И ПРОЧЕЕ.
\setcounter{equation}{10}% номер формул
% Эти счетчики достаточно задать один раз, обновляются дальше сами
% \newtop{ЗАГОЛОВОК}  юзать чтобы вручную поменть заголовок вверху страници

\begin{document}


\begin{center} %Решения упражнений
\ \newline
\Large \textbf{Решения упражнений}\\
\ \newline
\end{center}

\noindent\textbf{1. Десятичные цифры простых чисел}\\
\ \newline
\hspace*{15pt}Пусть $l$ -- длина $B$, т.е. $10^{l-1}\leqslant B <10^l$\: и \:$k\geqslant 0$. Тогда числа вида\linebreak
$n\cdot10^{k+1} + B\cdot10^k + c$ являются числами десятичная запись которых\linebreak
содержит последовательность $В$, если $ 0 \leqslant c < 10^k.$ Если $k > 0$, то\linebreak
можно взять $с$ взаимно простым с 10 и тогда числа $10^{k+1}$ и $B\cdot10^k + c$\linebreak
будут взаимно просты. Поэтому можно применить теорему Дирихле. В\linebreak действительности оказывается, что существует бесконечно много про­-\linebreak
стых чисел, содержащих фиксированную последовательность цифр $B$ в\linebreak
заранее заданных позициях.\\
\ \newline

\noindent\textbf{2. Вычисление НОД}\\

\hspace*{0pt} Допустим, что $m>n$. Тогда $a^m - b^m = (a^n-b^n)a^{m-n}+(a^{m-n}-b^{m-n}b^n)$.\linebreak 
Это тождество и условия взаимной простоты $a$ и $b$ дает\newline
$$\text{НОД}(a^m-b^m,\ a^n-b^n)=\text{НОД}(a^{m-n}-b^{m-n},\ a^n-b^n)=$$
	$$=\text{НОД}(a^{m\ mod\ n}-b^{m\ mod\ n},\ a^n-b^n),$$
Повторяя это соотношение как в алгоритме Евклида, получим искомый результат.
\ \newline

\noindent\textbf{3. Алгоритм Евклида и непрерывные дроби}\\
\\
\hspace*{10pt} \textbf{a.}\ Пусть $a/b$ — рациональное несократимое число (с $b > 0$). Тогда\linebreak 
последовательность частных, полученных в алгоритме Евклида, при­-\linebreak
мененном к $а$ и $b$, дает разложение $а/b$ в непрерывную дробь. К тому\linebreak
же все частные, за исключением, быть может, первого, положительны,\linebreak
если используемое деление является обычным делением Евклида.\linebreak

 \textbf{b.}\ Рассмотрим непрерывные дроби $s_i = [c_i,c_{i+1},..,c_m]$ и\linebreak
$t_i=[d_i,d_{i+1},...,d_n]$. Тогда, очевидно, имеем $s_i=c_i+1/s_{i+1}$ и \linebreak
аналогичное соотношение для $t$ и $d$. Отсюда получаем $s_i>1$ для $i<m$,\linebreak
и, следовательно, $[s_i] = c_i$. кроме того, по предположению, $s_0=$\linebreak
$=[c_0,c_1,...,c_m]=[d_0,d_1,...,d_n]=t_0$. Используя предыдущее соотношение,\linebreak
получаем $c_0=d_0$ (целые части $s_0$ и $t_0$) и $s_1=t_1$. Затем постепенно\linebreak \newpage

%===============================================================
% 271 страница

%\newtop{Решения упражнений} %!!!!!!!!!!!!!!!!!!!!

\noindent доказываем, что $c_i=d_i$. Этот процесс заканчивается на наименьшем \linebreak
из чисел $m$ и $n$. Допустим, что это $m$. Тогда $s_m=t_m$ и $c_m=d_m$ через\linebreak
предшествующую рекуррентность. Кроме того, $s_m=c_m$ по определе­нию $s$.\linebreak
В результате\:\: $c_m=d_m$\:\: и\:\: $m=n$.\newline
\ \newline
\hspace*{15pt}\textbf{c.} Достаточно рассмотреть последние деления алгоритма Евклида:\nolinebreak $$r_{n-2}=r_{n-1}a_{n-1}+1\quad\text{ и }\quad r_{n-1}=1\times r_{n-1} \quad\text{ с\: } r_{n-1}>1.$$
Последнее деление можно заменить на следующее:\:\: $r_{n-1}=1\times (r_{n-1}-1)+1$ \linebreak
без появления нулевого частного и закончить деление на $1=1\times1$.\linebreak
Это означает, что $$[c_0,c_1,c_2,...,c_n]=[c_0,c_1,c_2,...,c_n-1,1],\quad\text{если\: } c_n > 1.$$

Это эквивалентно факту, что любое целое число $a$ допускает ровно два
разложения в непрерывную дробь: $[a]$ и $[a-1,1]$.\newline\\
\hspace*{15pt}\textbf{d.} Вот часть ответа (развиваемая потом в упражнении 6):
\begin{gather*}
	[a_0]=a_0,\quad [a_0,a_1]=\frac{a_0a_1+1}{a_1},\quad
	[a_0,a_1,a_2]=\frac{a_0a_1a_2+a_0a_1+a_1a_2}{a_1a_2+1}...\text{\:,}\\
	F_4/F_3=[1,1,2]\quad \text{и}\quad F_5/F_4=[1,1,1,2].
\end{gather*}
\\

\noindent\textbf{4. Многочлены континуаты}\\
\\
\hspace*{15pt}\textbf{a.} Легко видеть, что $F_n=K_n(1,...,1)$. Это означает, что в $K_n$\linebreak
имеется $F_n$ слагаемых.\\
\\
\hspace*{15pt}\textbf{b.} Нетрудно проверить, что свойство верно для $n=$ —1, 0, 1.\linebreak
Рассмотрим моном $X_1...X_n$ . Можно разделить исключения примыкающих\linebreak
пар на две категории: те, которые исключают пару $X_nX_{n-1}$, и те,\linebreak
которые оставляют $X_n$. По предположению индукции, первая категория\linebreak
дает все одночлены от $K_{n-2}$, а вторая — все одночлены от $K_{n-1}$,\linebreak
умноженные на $X_n$. Отсюда результат (обнаруженный впервые Эйлером).\linebreak
\\
\hspace*{15pt}\textbf{c.} Следовательно, континуанты обладают зеркальной симметрией:\linebreak
$K_n(X_1,...,X_n)=K_n(X_n,...,X_1)$. Можно определить последователь­-\linebreak
ность $K_n$ следующим образом:
$$K_n=X_1K_{n-1}(X_2,...,X_n)+K_{n-2}(X_3,...,X_n).$$
Соотношение, которое будет использоваться в следующих упражне­ниях.\newpage

%========================================================================
%272
Требуемое тождество доказывается легко. Оно указывает, что в\linebreak
по­ле рациональных дробей
$$ \frac{K_n(X_1,...,X_n)}{K_{n-1}(X_2,...,X_n)}=[X_1,X_2,...,X_n]=X_1+\frac{1}{X_2+...}.$$
Если $r_{i-1}=r_ia_i+r_{i+1}$, где $r_n=1$ и $r_{n+1}=0$ есть последовательность\linebreak
делений алгоритма Евклида, примененного к целым взаимно простым\linebreak
числам, то $r_i=K_{n-i}(a_{i+1},...,a_n)$.\newline
\\

\noindent\textbf{5. Континуаты (продолжение)}\\
\\
\hspace*{15pt}\textbf{a.} Нетрудно доказать, используя индукцию, что рассматриваемое\linebreak
произведение равно матрице
$$\begin{pmatrix}
	K_n(X_1,...,X_n)& K_{n-	1}(X_1,...,X_{n-1})\\
	K_{n-1}(X_2,...,X_n)& K_{n-2}(X_2,...,X_{n-1})
\end{pmatrix}$$
\noindent Этот результат дает другое доказательство зеркальной симметричности\linebreak
многочленов континуант.\newline
\\
\hspace*{15pt}\textbf{b.} Вычислив определитель, находим искомое равенство (с точно­стью\linebreak
до индексов). Следовательно, значения $K_n(a_1,...,a_n)$ и\linebreak
$K_{n-1}(a_2,...,a_n)$ дают взаимно простые целые числа.\\
\\
\hspace*{15pt}\textbf{c.} Простая индукция показывает, что искомое произведение равно
$$\begin{pmatrix}
	K_{n+2}(X_1,...,X_{n+2})& K_{n+1}(X_2,...,X_{n+2})\\
	K_n(X_1,...,X_n)& K_{n-1}(X_2,...,X_n)
\end{pmatrix}$$
\noindent Определитель этой матрицы (что и требовалось доказать) равен
\begin{eqnarray*}
	X_{n+2}\Big( K_{n-1}(X_2,...,X_n) K_{n+1}(X_1,...,X_{n+1})-\quad\\
	-K_n(X_1,...,X_n)K_n(X_2,...,X_{n+1}) \Big),
\end{eqnarray*}
т.е.\:\: $(-1)^{n+1}X_{n+2}$\:\: по предыдущему пункту\\
\\

\noindent\textbf{6. Разложение в непрерывную дробь}\\
\\
\hspace*{15pt}\textbf{a.} Это решение уже намечено в упражнении 3:
$$[a_0]=a_0,\quad [a_0,a_1]=\frac{a_0a_1+1}{a_1},\quad [a_0,a_1,a_2]=\frac{a_0a_1a_2+a_0a_1+a_1a_2}{a_1a_2+1}...$$
\newpage

%===================================================================
%273
\noindent Формула выглядит так:
$$[a_0,a_1,...,a_n]=\frac{K_{n+1}(a_0,a_1,...,a_n)}{K_n(a_1,...,a_n)},$$
и доказывается по индукции. Попутно использовалось соотношение\linebreak
$[a_0,...,a_n]=[a_0,[a_1,...,a_n]]$ и равенство, выражающее зеркальность\linebreak
многочленов континуант.\\
\\
\hspace*{15pt}\textbf{b.} Требуемое соотношение вытекает прямо из определения \linebreak
последовательностей $(a_i)$ и $(x_i)$. Запишем
\begin{equation}
	\begin{split}
		|x-[a_0,...,a_n]|&=|[a_0,...,a_n,x_{n+1}]-[a_0,...,a_n]|=\\
		&=\bigg|\frac{ K_{n+2}(a_0,...,a_n,x_{n+1} }{ K_{n+1}(a_1,...,a_n,x_{n+1} }
		-\frac{ K_{n+1}(a_0,...,a_n) }{K_n(a_1,...,a_n)} \bigg|= \\
		&=\frac{1}{ K_n(a_1,...,a_n)K_{n+1}(a_1,...,a_n,x_{n+1}) }
	\end{split}
\end{equation}
Очевидно, $x_{n+1}$ положительно (по построению) и континуанты возра­стают\linebreak
(хорошо видно, каким образом ), следовательно, получаем
\begin{equation}
	\big|x-[a_0,...,a_n]\big|\leqslant \frac{1}{K_n(a_1,...,a_n)^2}<\frac{1}{2K_n(a_1,...,a_n)},
\end{equation}

\noindent Соотношение, которое впоследствии понадобится. Это доказывает\linebreak 
схо­димость $x$. Можно также констатировать, что подходящие\linebreak веществен­ные числа дают очень хорошие аппроксимации указанного чис-\linebreak
ла. В действительности, как увидим в дальнейшем, они даже наилучшие.\newline
\\
\hspace*{15pt}\textbf{c.} Установленная в пункте \textbf{(a)} формула дает значение в неприводи­мой\linebreak 
форме, ибо, согласно упражнению 5, вводимые туда числа взаимно\linebreak
просты. Остается их только вычислить, что и сделаем, применяя рекур­-\linebreak
рентное определение континуант и значений многочленов. Приводим\linebreak
совмещенные вычисления числителя и знаменателя, чтобы\linebreak 
минимизи­ровать необходимые операции.
\begin{lstlisting}[mathescape=true]
$K\longleftarrow1;$ $K'\longleftarrow a_n$;
for (int i=n-1; i>=0; i=i-1){
	$(K',K)\longleftarrow(a_iK'+K,K')$;
}
\end{lstlisting}
%\newline
В начале итерации для значения $i$ имеем инвариантное отношение
$$ \frac{K'}{K}=[a_{i+1},...,a_n] $$
\newpage
%
%273
%==================================================================
%274
%
\noindent Этот алгоритм(который оперирует с коэффициентами разложения),\linebreak
разумеется, не должен использоваться для вычисления последователь-­\linebreak
ности подходящих дробей, так как каждый промежуточный этап не\linebreak
дает первые подходящие дроби.\newline
\hspace*{15pt}Если необходимо вычислить последовательность подходящих дро­бей,\linebreak
то можно использовать потоковый алгоритм разложения. Для это­го \linebreak
используют две рекуррентные последовательности, определяемые через\nolinebreak
\begin{center}
	$P_0=1,\quad P_1=a_0,\quad P_n=a_nP_{n-1}+P_{n-2},$\\
	$Q_0=0,\quad Q_1=1,\quad Q_n=a_nQ_{n-1}+Q_{n-2}.$
\end{center}

\noindent Итак, определяемые последовательности удовлетворяют соотношению\linebreak
$[a_0,...,a_n]=P_{n+1}/Q_{n+1}.$ \quad Это нас приводит к алгоритму 5.
\begin{center}
\begin{lstlisting}[mathescape=true][xrightmargin=1cm]
	int a;
	scanf("%d", &a);
	$P\longleftarrow1;$ $P'\longleftarrow a;$ $Q\longleftarrow 0;$ $Q'\longleftarrow 1;$
	printf("%d$\text{ }$%d\n", $P',\text{ }Q'$);
	while(){
		scanf("%d", &a);
		$(P',P)\longleftarrow (aP'+P,P');$ $(Q',Q)\longleftarrow(aQ'+Q,Q');$
		printf("%d$\text{ }$%d\n"$,$ $P',\text{ }Q'$);
	}
\end{lstlisting}
\textbf{Алгоритм 5.} Вычисление текущих подходящих дробей
\end{center}
\ \linebreak
\hspace*{15pt}\textbf{d.} Число золотого сечения удовлетворяет уравнению $x=1+1/x$.\linebreak
Следовательно, его разложение в непрерывную дробь есть $[1,1,1,1,...]$.
Последовательность подходящих дробей, согласно пункту \textbf{(a)} упражне­ния 4\linebreak
и предшествующему пункту \textbf{(a)} упражнения 6, есть отношения\linebreak
последовательных чисел Фибоначчи: $F_2/F_1,F_3/F_2,F_4/F_3,...$\newline
\\
\noindent\textbf{7. Аппроксимация вещественных чисел с помощью \newline \hspace*{13pt}непрерывных дробей}\\
\\
\hspace*{15pt}\textbf{a.} Выражение $p_{n+1}q_{n-1}-q_{n+1}p_{n-1}=K_{n+2}K_{n-1}-K_{n+1}K_n$ есть знак\linebreak 
$(-1)^{n+1}$, откуда следует результат. Выражение $p_{n+1}q_n-q_{n+1}p_n=$\linebreak
$K_{n+2}K_n-K_{n+1}K_{n+1}$ есть знак $(-1)^n$. Факт, что $x$ находится между двумя сходящимися последовательностями показывает, что эти последовательности сходятся к $x$.\newline
\\
\hspace*{15pt}\textbf{b.} Равенство (11) утверждает, что
$$\Bigg|x-\frac{p_n}{q_n}\Bigg| = \big|x-[a_0,...,a_n]\big|=\frac{1}{K_n(a_1,...,a_n)K_{n+1}(a_1,...,a_n,x_{n+1})}.$$\newpage


%================================================================
%275
\noindent
Используя двустороннюю оценку $a_{n+1}<x_{n+1}<a_{n+1}$, а также, что каждая\linebreak
континуата --- возрастающая функция любой из этих переменных,\linebreak получаем
$$\frac{1}{q_nK_{n+1}(a_1,...,a_n,a_{n+1}+1)}<\bigg|x-\frac{p_n}{q_n}\bigg|<\frac{1}{q_nq_{n+1}}$$
Но $K_{n+1}(X_1,...,X_n,X_{n+1}+1)$. Действительно, первая континуанта, по\linebreak
определению, равна $K_{n+2}(X_1,...,X_{n+1},1)$, тогда как вторая равна по\linebreak
определению $K_{n+1}(X_1,...,X_{n+1})+K_n(X_1,...,X_n)$, \:\:т.е. второй континуанте.\linebreak
Следовательно,
$$ K_{n+1}(a_1,...,a_n,a_{n+1}+1)\leqslant K_{n+2}(a_1,...,a_{n+1},a_{n+2})=q_{n+2},$$
откуда и получается требуемая оценка. Другие неравенства выводятся\linebreak
немедленно.\newline
\\
\hspace*{15pt}\textbf{c.} Зная, что $|x-p_n/q_n|<1/2q_n$ (соотношение (12)), и что\linebreak
$|p_n/q_n-p/q|\geqslant1/q_n$ (так как $q=q_n$), получаем, что $|x-p/q|>1/2q_n$,
что и дает искомое неравенство.\newline
\\
\hspace*{15pt}\textbf{d.} Матричные соотношения показывают, что матрица 
$\begin{pmatrix}
	p_n&  p_{n-1}\\
	q_n& q_{n-1}\\
\end{pmatrix}$\linebreak
обратима над $\mathbb{Z}$. Следовательно, можно записать $p=\alpha p_n+\beta p_{n-1}$ и \linebreak
$q=\alpha q_n+\beta q_{n-1}$, где $\alpha$ и $\beta$ — целые. Однако $q<q_n$, откуда следует,\linebreak
что $\beta$ — не нуль и что $\alpha$ и $\beta$ имеют противоположные знаки. Кроме\linebreak
того, согласно доказанному в вопросе (а), $p_n-xq_n$ и $p_{n-1}-xq_{n-1}$ тоже\linebreak
имеют противоположные знаки. Отсюда $\alpha(p_n-xq_n)$ и $\beta(p_{n-1}-xq_{n-1}$\linebreak
одного\:\: знака,\:\: а\:\: потому
$$|p-xq|=|\alpha(p_n-xq_n)+\beta(p_{n-1}-xq_{n-1})|\geqslant|\beta|\cdot|p_{n-1}-xq_{n-1})|>|p_n-xq_n|$$
\\
\noindent\textbf{8. Факториал и простые числа} \newline 
\\
\hspace*{15pt}\textbf{a.} Пусть $n=p_1^{\alpha_1}...p_r^{\alpha_r}$  — разложение $n$ на простые множители. \linebreak
Предположим сначала, что $r>1$. Тогда $p_i^{\alpha_i}<n$ и, следовательно, делит\linebreak
$(n-1)!$. Если $r=1$, то так как $n$ — непростое, это приводит к тому,\linebreak
что $\alpha_1>1$. Если $\alpha_1=2$, то числа $p_1$ и $2p_1$ встречаются в разложении\linebreak
$(n-1)!$, кроме случая $p_1=2$. Если $\alpha_1>2$, то числа $p_1$ и $p_1^{\alpha_1}$ меньше $n$\linebreak
и, следовательно, появляются в разложении $(n-1)!$.\newline
\\
\hspace*{15pt}\textbf{b.} Действительно, очевидно, что всякое целое число $k$ из интервала\linebreak
$[2, n+1]$ делит $(n+1)!+k$. Отсюда мы нашли те целые числа, которые\linebreak
искали.\newpage

%275
%=====================================================================
% 276
\noindent\hspace*{15pt}\textbf{c.} Одно из двух: либо $n!+1$ — простое число, и тогда задача реше­на,\linebreak
либо оно составное. В последнем случае оно не может делиться на\linebreak
простое число, меньшее или равное $n$. Итак, оно делится на простое, большее $n$, и, разумеется, $<n!+1$. Это доказательство, в действитель­ности, аналогично доказательству Евклида бесконечности множества простых чисел.\newline
\\
\hspace*{15pt}\textbf{d.} Первые числа $e_i$ являются, действительно, простыми: $e_1=2$,\linebreak
$e_2=3,~e_3=7,~e_4=43$. Однако следующее\:\: $e_5=1807=13\times139$\:\: уже нет.\linebreak
В действительности при $5\leqslant i\leqslant17$ числа $e_i$ составные. Эти числа, очевидно,\linebreak
взаимно простые. Можно также доказать, что существует такая\linebreak
вещественная константа $E\approx1,26$, что $e_n=\lfloor E^{2n}+\frac{1}{2}\rfloor$, но это похоже\linebreak
на шутку, как и для константы $K$ из упражнения 40.\newline
\\
\noindent\textbf{9. Каноническое разложение n! } \newline 
\\
\hspace*{15pt}Если $v_p(m)$ обозначает показатель, с которым простое число $p$ вхо­дит\linebreak
в число $m$, то $v_p(n!)=\sum_{1\leqslant m\leqslant n}v_p(m)$ и остается только доказать, что\linebreak
эта сумма равна $S_n=\sum^{\infty}_{i=1}\lfloor n/p^i\rfloor$. Это можно сделать по индук­ции,\linebreak
доказывая, что $S_{n+1}=S_n+v_p(n+1)$, и проверяя, что $S_1=0$. Если $a$ и $b$\linebreak
— два целых числа, то записывая $a=bq+r$, где $0\leqslant r<b$, легко доказать,\linebreak
что $\lfloor(a+1)/b\rfloor-\lfloor a/b\rfloor$ равно $0$, если $b\dagger a+1$, и равно $1$, если $b~|~a+1$.\linebreak
Следовательно,
\begin{equation*}\lfloor (n+1)/p^i\rfloor - \lfloor n/p^i\rfloor =
\begin{cases}
	1,& \text{если }i\leqslant v_p(n+1),\\
	0& \text{в противном случае.}\\
\end{cases}
\end{equation*}
Отсюда $S_{n+1}-S_n=\sum_{1\leqslant i\leqslant v_p(n+1)}1=v_p(n+1)$.\newline
\\
\noindent\textbf{10. Уравнение Ферма для $n=2$ и $n=4$} \newline 
\\
\hspace*{15pt}\textbf{a.} Если $x$ и $y$ нечетны,\:\: $x^2\equiv y^2\equiv 1~(mod~4)$\:\: и, следовательно,\linebreak
$z^2\equiv 2~(mod~4)$, что невозможно. Если $(x,y,z)$ — решение уравнения,\linebreak
то $(dx,dy,dz)$ — также решение уравнения для любого $d\in \mathbb{Z}$. Обратно,\linebreak
если $d=\text{НОД}(x,y)$, то $d^2|z^2$, откуда $d|z$ и $(x/d,~y/d~,z/d)$ — также\linebreak
решения.\newline
\\
\hspace*{15pt}\textbf{b.} Если $(x+iy)=(1+i)(\alpha+i\beta)$, то $x=\alpha-\beta$ и $y=\alpha+\beta$, что дает\linebreak
искомый результат (см. по этому поводу упражнение 12).\\

В $\mathbb{Z}[i]$ имеем $z^2=(x+iy)(x-iy)$, где $x$ и $y$ имеют \textbf{противоположную}\linebreak
\textbf{четность}. Отсюда ясно, что $x+iy$ и $x-iy$ взаимно просты.\linebreak
Действительно, единственное неприводимое число $\pi$, которое мог­ло бы\linebreak
делить одновременно $x+iy$ и $x-iy$, должно делить их сумму $2x$\linebreak
%
%276
%===================================================================
%______Внимательно, тк выше нет разрыва страницы!!!!_________________
% 277
%
\noindent и разность $2y$, а потому и число 2, являющееся линейной комбинацией\linebreak
$2x$ и $2y$. Но разложение 2 на неприводимые есть $(1+i)(1-i)$, тогда как\linebreak 
ни $1+i$, ни $1-i$ не делят $x+iy$ ($x$ и $y$ противоположной четности).

Однако в факториальном кольце (каковым является $\mathbb{Z}[i]$), если про\linebreak
изведение двух взаимно простых множителей является квадратом, то\linebreak
это же справедливо и для каждого из сомножителей, являющихся взаим-\linebreak
но простыми, с точностью до \textbf{обратимых элементов}. Итак, $x+iy=$\linebreak
$=\pm i(\alpha+i\beta)^2$ со взаимно простыми $\alpha$ и $\beta$, что отвечает на прямую поло-\linebreak
вину вопроса. Обратное легко проверить непосредственно.

Например, $3^2+4^2=5^2~(u=1,~v=2),~~5^2+12^2=13^2~(u=2,~v=3)$.\newline
\\
\hspace*{15pt}\textbf{c.} Предположим, что $x$ и $y$ взаимно просты. Тогда можно считать,\linebreak
что $x$ нечетно, $y=2y'$ — четно. Следовательно, $z$ нечетно. Теперь\linebreak
достаточно записать $y^2=(z-x)(z+x)$, а затем $y'^2=\frac{z-x}{2}\frac{z+x}{2}$. Два\linebreak
взаимно простых числа $\frac{z-x}{2}$ и $\frac{z+x}{2}$ дающие в произведении квадрат,\newline
сами являются квадратами. Поэтому немедленно получаем решение.\newline
\\
\hspace*{15pt}\textbf{d.} Можно предположить, что $x$ и $y$ взаимно просты. Запишем\linebreak
$x^4+y^4=(x^2)^2+(y^2)^2$ и, применяя предыдущий результат, предполагая\linebreak
(при необходимости $x$ и $y$ можно поменять местами), что $x$ нечетно, $y$\linebreak
четно, получим:
$$x^2=u^2-v^2,\quad y^2=2uv,\qquad u,v>0,\quad \Nod(u,v)=1.$$
Тогда имеем $x^2+v^2=u^2$ с $\Nod(x,v)=1$. Применим еще раз предыдущий\linebreak
результат, учитывая, что $x$ нечетно:
$$x=a^2-b^2,\quad v=2ab,\quad u=a^2+b^2,\qquad a,b>0,\quad\Nod(a,b)=1.$$
Отсюда выводим $y^2=2uv=4uab$. Однако $u$, $a$ и $b$ попарно взаимно\linebreak
просты, а произведение $4uab$ --- квадрат. Следовательно, $u$, $a$ и $b$ ---\linebreak
квадраты: $a=c^2$, $b=d^2$. Поэтому
$$c^4+d^4=a^2+b^2=u\text{\: квадрат}.$$
Но $x^4+y^4=(u^2+v^2)^2>u=c^4+d^4$. Доказательство закончено, так как\linebreak
в $\mathbb{N}$ не существует бесконечной строго убывающей последовательности\linebreak
\textit{(это и есть метод бесконечного спуска, принадлежащий Ферма)}.\newline
\\

\noindent\textbf{11. Простое \textbf{диофантово уравнение} } \newline 
\\
\hspace*{15pt}\textbf{a.} Пары $(\pm i,0)$ и $(\pm 2i,\pm i)$ являются решениями в $\mathbb{Z}[i]$.\\
\\
Если бы существовало целое решение, то оно удовлетворяло бы со-\linebreak
отношению $3y^2=x^2+1$, что невозможно, так как 3 не может делить\linebreak
\pagebreak
%
%277
%=====================================================================
%278
%
\noindent сумму двух квадратов, стоящую справа (более простое рассуждение \linebreak
за­ключается в том, чтобы привести уравнение по модулю 3, аналогично\linebreak
тому, как это сделано в следующем вопросе).\newline
\\
\hspace*{15pt}\textbf{b.} Приведя уравнение по модулю 5, получаем $x^2+z^2=0$. Однако\linebreak
2 не является корнем квадратным из —1 по модулю 5. Следовательно,\linebreak
$z\equiv\pm2~(mod~5)$, что дает нам решение $(k,\pm k,\pm 2k)$. Однако оно не\linebreak
единственно.\newline

\noindent\hspace*{15pt}\textbf{c.} Очевидно, что решений нет, если —1 не является квадратичным\linebreak
вычетом по модулю $p$. Поэтому $p\equiv1~(mod~4)$. При этих условиях (мы это\linebreak
уже видели) число $p$ может быть записано в виде суммы двух квадратов,\linebreak
что дает бесконечное множество решений рассматриваемого уравнения.\newline
\\

\noindent\textbf{12. Кольцо $\mathbb{Z}[\theta]/(a+\theta b),~\theta$ --- квадратичная иррациональность,\linebreak \hspace*{27pt}$\Nod(a,b)=1$ } \newline 
\\
\hspace*{15pt}\textbf{a.} Если доказать, что $[i]_{a+ib}=\varphi(t)$, то $[x+iy]_{a+ib}=\varphi(x+ty)$, что до-\linebreak
казывает сюръективность $\varphi$. Достаточно рассмотреть в $\mathbb{Z}[i]$ уравнение\linebreak
$i-t=(a+ib)(v+iu)=(av-bu)+i(au+bv)$. Если $u$, $v$ — коэффициенты\linebreak
Безу для $a$ и $b$ и положить $t=bu-av$, то получим искомое соотношение.\linebreak
\\
\hspace*{15pt}\textbf{b.} Если $\Ker \varphi=(a^2+b^2)\mathbb{Z}$, то $\varphi$ индуцирует изоморфизм $\mathbb{Z}/(a^2+b^2)$\linebreak
на $\mathbb{Z}/(a+ib)$, а так как $t$ переходит в $i$, то имеем $t^2\equiv-1~(mod~a^2+b^2)$.\linebreak
Из очевидного сравнения $a^2\equiv-b^2~(mod~ a^2 + b^2)$ получаем $(ab^{-1})^2\equiv-1$\linebreak
$(mod~a^2+b^2)$, где $b^{-1}$ --- обратный элемент к $b$ по модулю $a^2+b^2$.\linebreak
Следовательно, если $a+tb\equiv 0~(mod~ a^2+b^2)$, то $t\equiv -ab^{-1}~(mod~a^2+b^2)$,\linebreak
откуда $t^2\equiv -1~(mod~a^2+b^2)$. Для выбранного $t$, $t=bu-av$, известно,\linebreak
что $a+tb\equiv0~(mod~a^2+b^2)$ и элемент $t=bu-av$ и в самом деле является\linebreak
противоположным к $ab^{-1}$ по модулю $a^2+b^2$.\\
\\
\hspace*{15pt}\textbf{\textit{Примечание}}

\hspace*{10pt} Используя выражение $t=bu-av$ и равенство $au+bv=1$ с помощью\linebreak
прямых вычислений можно показать, что $t^2\equiv-1 ~(mod~a^2+b^2)$. Но\linebreak
можно также использовать соотношение $t-i\equiv0~(mod~a+ib)$, откуда\linebreak
$t+i\equiv0~(mod~a--ib)$, из чего выводим $t^2+1\equiv0~(mod~a^2+b^2)$.$\qquad \blacksquare$ \linebreak
\\
\hspace*{15pt}\textbf{c.} Положив $\mu(x+iy)=x+ty$ и используя соотношение $t^2\equiv-1$\linebreak
$(mod~a^2+b^2)$, покажем, что $\mu:\mathbb{Z}[i]\rightarrow\mathbb{Z}/(a^2+b^2)$ --- \textit{морфизм колец}.\linebreak
Ясно, что $\mu(m)=m$ для $m\in\mathbb{Z}$ и $\mu(a+ib)=a+tb\equiv0~(mod~a^2+b^2)$.\linebreak
Отсюда следует, что $\mu$ дает переход к факторкольцу и $Ker~\varphi=$\linebreak
$=(a^2+b^2)\mathbb{Z}$, где равенство следует из того, что $\mu$ и $\varphi$ индуцируют\linebreak
взаимно обратные морфизмы.\newpage
%
%278
%======================================================================
%279

К примеру, $1+i$ делит $x+iy$ тогда и только тогда, когда $x$ и $y$ одной\linebreak
четности. Для $a+ib=9+2i$ имеем $t=38$ и потому $x+iy$ делится на\linebreak
$9+2i$ тогда и только тогда, когда $x+38y$ делится на 85.\newline
\\
\hspace*{15pt}\textbf{d.} $\mathbb{Z}[i]/(a+ib)$: Существуют два очевидных случая, когда кольцо\linebreak
$\mathbb{Z}[i]/(a+ib)$ состоит из $(a^2+b^2)$ элементов. Первый случай --- когда\linebreak
$b=0$, второй --- когда $a$ и $b$ взаимно просты и кольцо $\mathbb{Z}[i]/(a+ib)$ \linebreak
изоморфно $\mathbb{Z}/(a^2+b^2)$. В общем случае, если $d=\Nod(a,b),~a=da'$,\linebreak
$b=db'$ каноническое отображение $\mathbb{Z}[i]/(a+ib)$ в $\mathbb{Z}[i]/(d)$ сюръек­тивно\linebreak
и с ядром, изоморфным $\mathbb{Z}[i]/(a'+ib')$ (каноническая инъекция\linebreak
$\mathbb{Z}[i]/(a'+ib')\rightarrow \mathbb{Z}[i]/(a+ib)$ получается умножением на $d$ и образ --- в\linebreak
точности это кольцо), откуда следует результат.\newline
\\
\hspace*{15pt}\textbf{e.} Кольцо $\mathbb{Z}[\theta]$ снабжено автоморфизмом, который переводит $\theta$ в\linebreak
другой корень $\widetilde{\theta}$ уравнения $X^2-SX+P=0$ и нормой: $N(a+b\theta)=$\linebreak
$=(a+b\theta)(a+n\widetilde{\theta})=a^2+Sab+Pb^2$. Положив $z=a+b\theta$, докажем, что\linebreak
кольца $\mathbb{Z}[\theta]/(z)$ и $\mathbb{Z}/N(z)$ изоморфны.

Для этого достаточно найти в $\mathbb{Z}/N(z)$ элемент $t$, играющий роль $\theta$\linebreak
в $\mathbb{Z}[\theta]/(z)$, т.е. $a+bt\equiv0~(mod~N(z))$. Это возможно, так как $b$ взаимно\linebreak
просты с $N(z)=a^2+Sab+Pb^2$. Следовательно, он обратим по модулю\linebreak
$a^2+Sab+Pb^2$ и потому $t=-ab^{-1}~(mod~N(z))$. Элемент $t$ удовлетворяет\linebreak
тому же уравнению, что и $\theta$:
$$t^2-St+P\equiv0~(mod~N(z)).$$
Докажем теперь, что отображение $\mu:\mathbb{Z}[\theta]\rightarrow\mathbb{Z}/N(z)$, определенное\linebreak
по правилу $\mu(x+y\theta)=x+yt$, является морфизмом колец, который\linebreak
можно пропустить через  $\mathbb{Z}[\theta]/(z)\rightarrow\mathbb{Z}/N(z)$. Впрочем, $N(z)$ делится\linebreak
на z и потому имеется канонический морфизм $\varphi:\mathbb{Z}/N(z)\rightarrow\mathbb{Z}[\theta]/(z)$.\linebreak
Тот факт, что эти морфизмы взаимно обратны, равносилен тому, что\linebreak
$t\equiv\theta~(mod~z)$, и это как раз тот случай, так как $bt\equiv-a\equiv b\theta~(mod~z)$.\linebreak
Последнее равенство можно упростить, сократив на $b$ ($b$ обратим по\linebreak
модулю $z$ ввиду $ua+vb=1$, что приводит к $u(a+b\theta)+(v-u\theta)b=1)$.\linebreak
Отсюда можно сделать вывод, что кольцо $\mathbb{Z}[\theta]/(z)$ состоит из $|N(z)|$\linebreak
элементов для взаимно простых $a$ и $b$, а затем перейти к случаю\linebreak
произвольных $a$ и $b$.\newline
\\
\noindent\textbf{13. НОД в $\mathbb{Z}[i]$ и суммы двух квадратов} \newline 
\\
\hspace*{15pt}\textbf{a.} Специфическое предположение для $\mathbb{Z}[i]$, что $p$ делит\linebreak
(x+i)(x-i). Тогда $z=u+iv=\Nod(p,x+i)$ является \textbf{настоящим}\linebreak
делителем $p$: действительно,$z$ не может быть обратимым (если $\pi$\linebreak
неприводимый элемент в $\mathbb{Z}[i]$, делящий $p$, то он делит $(x+i)(x-i))$.\linebreak
Сле­довательно, $\pi$ или $\pi$ делит $p$ и $x+i$ и $z$ не является ассоциированным\newpage
%
%279
%=====================================================================
%280
%
с $p$ (так как $p\nmid x+i$). Поэтому, если $z'$ такое число, что $zz'=p$, то\linebreak
$$N(z)N(z')=p^2\quad\Rightarrow\quad N(z)=u^2+v^2=p.$$
Используя вычисление НОД в $\mathbb{Z}[i]$, находим:
$$1~301=25^2+26^2,\quad1~000~037=991^2+134^2,\quad 2~000~004~973=39~027^2+21~838^2.$$
\hspace*{15pt}\textbf{b.} Если $z=u+iv=\Nod(n,x+iy)$, числа $u$ и $v$ взаимно просты\linebreak
то можно применить результат упражнения 12. Так как $z$ делит $n$, $z\overline{z}$\linebreak
делит $n$. С другой стороны, так как $z\in n\mathbb{Z}[i]+(x+iy)\mathbb{Z}[i]$, то получаем
\begin{eqnarray*}
z\overline{z}\in(n\mathbb{Z}[i]+(x+iy)\mathbb{Z}[i])(n\mathbb{Z}[i]+(x-iy)\mathbb{Z}[i])\subset\qquad\\
\subset n\mathbb{Z}[i]+(x^2+y^2)\mathbb{Z}[i]=n\mathbb{Z}[i].
\end{eqnarray*}
Целые числа $n$ и $z\overline{z}$ делят друг друга, откуда следует их равенство.\newline
\\
\hspace*{15pt}\textbf{c.} Имеем $y_k=y^{p-1}=1$ (малая теорема Ферма). Для $y\in H$ пусть\linebreak
$i$ --- наибольшее целое число, такое, что $y_i\neq1;~1\leqslant i\geqslant k$, так как, с\linebreak
одной стороны, $y_k=1$, а с другой, $y_1\neq 1$ по предположению. Так как\linebreak
$1=y_{i+1}=y_i^2$ , то получаем, что $y_i=-1$ и $y_{i-1}$ --- корень квадратный\linebreak
из —1 по модулю $p$. Чтобы пересчитать $H$, рассмотрим его дополнение\linebreak
\textit{(плохие элементы)} $G=\{ y\in U(\mathbb{Z}_p),~y^{2q}=1\}$. Это подгруппа \textbf{циклической}\linebreak
группы $U(\mathbb{Z}_p)$. Несложное рассуждение показывает, что $|G|=2q$\linebreak
и, следовательно, $\frac{|G|}{|U(\mathbb{Z}_p)|}=\frac{1}{2^{k-1}}\leqslant \frac{1}{2}$. Вероятность случайным образом\linebreak
выбрать $m$ плохих элементов, следовательно, $\frac{1}{2^m}$. Можно запрограм-\linebreak
мировать вероятностный алгоритм, приведенный ниже (не забывайте\linebreak
вычислять $y^q~mod~p$ при помощи дихотомии!) и сравнить его с детер­-\linebreak
министским алгоритмом, который дает $(\frac{p-1}{2})!~\mod{p}$ как корень\linebreak 
ква­дратный из --1 (который из двух более эффективен?).\\
\begin{lstlisting}[mathescape=true,showspaces=false]
	do{
		$\text{Выбрать}$ $y$ $\text{случайно в}$ $[2...p-2];~y\longleftarrow y^q\mod{p};~y'\longleftarrow y^2$;
	}while( $y'==1$ );
	while( $y'\neq-1\mod{p}$ )
	{		 						//$y'=y^2$
		$y\longleftarrow y'$;
		$y'\longleftarrow y^2$;
	}     				  //$y~-~\text{корень квадратный из -1 по модулю }p$
\end{lstlisting}
\ \newline
\noindent\textbf{14. Делимость сумм $x^2+2y^2$} \newline 
\\
\hspace*{15pt}\textbf{a.} Норма $N$ может быть продолжена на поле $\mathbb{Q}[\sqrt{-2}]$, подполе поля\linebreak
$\mathbb{C}$,\: натянутое\: на\: 1\: и\:\: $\sqrt{-2}$.\:\: $\mathbb{Q}[\sqrt{-2}]$\:\: есть\: расширение\: степени 2 с базой%\linebreak
\pagebreak
%
%280
%====================================================================
%281

\noindent $\{1,\sqrt{-2}\}$, и, конечно, продолженная норма остается \textit{мультипликативной}.\\

Если $c=r+t\sqrt{-2}\in\mathbb{Q}[\sqrt{-2}]$ и $x$, $y~\in~\mathbb{Z}$ выбраны так, что $|r-x|\leqslant\frac{1}{2}$\linebreak
и $|t-y|\leqslant\frac{1}{2}$, то, обозначая $x+y\sqrt{-2}$ через $q$, имеем:
$$ N(c-q)=(r-x)^2+2(t-y)^2\leqslant\frac{1}{4}+\frac{2}{4},$$
откуда $N(c-q)<1$.

Если $a$ и $b$ --- два элемента $\mathbb{Z}[\sqrt{-2}]$, где $b\neq0$, то достаточно при-\linebreak
менить этот результат с $a/b\in\mathbb{Q}[\sqrt{-2}]$, чтобы найти $q\in\mathbb{Z}[\sqrt{-2}]$ такое,\linebreak
что $N(a/b-q)<1$ или $N(a-bq)<N(b)$, что доказывает евклидовость
$\mathbb{Z}[\sqrt{-2}]$ относительно $N$.\newline
\\ 
\hspace*{15pt}\textbf{b.} С помощью рассуждений, совершенно аналогичных доказатель­ству\linebreak
леммы 5, докажем, что для неприводимого числа $z$ из $\mathbb{Z}$ выполнено:\linebreak
$N(z)$ --- простое число. Копируя доказательство предложения 6, мож­но\linebreak
показать, что положительный делитель $x^2+2y^2$, где $x$ и $y$ взаимно\linebreak
просты, имеет форму $u^2+2v^2$.\newline
\\
\hspace*{15pt}\textbf{c.} Если $p$ представляется в виде $p=x^2+2y^2$, то $y$ не нуль по модулю\linebreak
$p$ и $-2=(xy^{-1})^2$ в $\mathbb{Z}/p\mathbb{Z}$, так как $y$ обратим в $\mathbb{Z}_p$; значит $-2$ --- квадрат\linebreak
по модулю $p$.

Обратно, если $-2$ есть квадрат по модулю $p$, то найдется $x$\linebreak 
та­кой, что $p$ делит $x^2+2$. Согласно предыдущему, $p$ представимо в виде\linebreak
$u^2+2v^2$.\newline
\\

\noindent\textbf{15. Делимость целых чисел вида $x^2-2y^2$} \newline 
\\
\hspace*{15pt}\textbf{a.} На этот раз кольцо есть $\mathbb{Z}[\sqrt{2}$. В отличие от уже изученных\linebreak 
слу­чаев это кольцо \textbf{вещественное}: $\{1,\sqrt{-2}\}$ является $\mathbb{Z}$-базой $\mathbb{Z}[\sqrt{-2}]$.\linebreak
Кольцо частных его есть поле $\mathbb{Q}[\sqrt{-2}]$, имеющее инволютивный автомор-\linebreak
физм $z\mapsto\widetilde{z}$, который $z=r+t\sqrt{2}$ ставит в соответствие $\widetilde{z}=r-t\sqrt{2}$. Этот\linebreak
автоморфизм оставляет на месте $\mathbb{Z}[\sqrt{2}]$ и позволяет определить мульти-\linebreak
пликативную норму $N$ через $N(z)=z\widetilde{z}$. Другими словами $N(r+t\sqrt{2})=$\linebreak
$=r^2-2t^2$. Доказательство того, что $\mathbb{Z}[\sqrt{2}]$ является евклидовым для $|N|$,\linebreak
аналогично решению упражнения 14. Заметим, однако, что $N$ может\linebreak
принимать отрицательные значения, откуда и использование абсолют­ного\linebreak
значения $N$.\newline
\\
\hspace*{15pt}\textbf{b.} Заметим, что —1 является нормой: $-1=1^2-2\times1^2=N(1+\sqrt{2})$.\linebreak
Используя рассуждения, аналогичные предложению 6, докажем, что \linebreak
делитель\: (положительный или нет) числа\: вида\: $x^2-2y^2$\: ($x$\: и\: $y$\:\hspace{3pt} взаимно

\pagebreak
%
%281
%========================================================================
%282
%
\noindent простые) имеет вид (с точностью до знака $\pm1$) и $u^2-2v^2$. Но равенство\linebreak
$$-(u^2-2v^2)=N((1+\sqrt{2})(u+v\sqrt{2}))=(u+2v)^2-2(u+v)^2$$
позволяет пренебречь знаком $\pm$. Следуя соответствующему этапу \linebreak
ре­шения упражнения 13, можно доказать, что нечетное простое число\linebreak
$p$ имеет вид $x^2-2y^2$ тогда и только тогда, когда 2 является квадратом\linebreak
по модулю $p$, что эквивалентно $|p|\equiv\pm1~(\mod{8}~)$.\newline
\\

\noindent\textbf{16. Кольца $\mathbb{Z}[\sqrt{-3}]$ и $\mathbb{Z}[\sqrt{10}]$ нефакториальны} \newline 
\\
\hspace*{15pt}\textbf{a.}

\newpage
%
%282
%========================================================================
%283
%
325245
\newpage
%
%283
%========================================================================
%284
%
sdfg
\newpage
%
%284
%========================================================================
%285
%
ewgfw

\newpage
%
%285
%========================================================================
%286
%
adsfa
\newpage
%
%286
%========================================================================
%287
%
adsf
\newpage
%
%287
%========================================================================
%288
%
AZCX
\newpage
\end{document}
